{
  "alerts": [
    {
      "name": "HighErrorRate",
      "expression": "rate(neonpro_api_errors_total[5m]) > 0.1",
      "for": "5m",
      "labels": {
        "severity": "critical",
        "component": "api",
        "healthcare_impact": "high"
      },
      "annotations": {
        "summary": "High API error rate detected",
        "description": "API error rate is {{ $value }} errors per second for the last 5 minutes. This may affect patient care and appointment scheduling.",
        "runbook_url": "https://docs.neonpro.healthcare/runbooks/api-errors"
      }
    },
    {
      "name": "DatabaseConnectionFailure",
      "expression": "up{job=\"neonpro-database\"} == 0",
      "for": "1m",
      "labels": {
        "severity": "critical",
        "component": "database",
        "healthcare_impact": "critical"
      },
      "annotations": {
        "summary": "Database connection failure",
        "description": "Database is not accessible. This affects all patient data access and medical records.",
        "runbook_url": "https://docs.neonpro.healthcare/runbooks/database-failure"
      }
    },
    {
      "name": "SlowApiResponse",
      "expression": "histogram_quantile(0.95, neonpro_api_request_duration_seconds_bucket) > 5",
      "for": "5m",
      "labels": {
        "severity": "warning",
        "component": "api",
        "healthcare_impact": "medium"
      },
      "annotations": {
        "summary": "Slow API response times",
        "description": "95th percentile response time is {{ $value }} seconds. This may impact user experience for healthcare providers.",
        "runbook_url": "https://docs.neonpro.healthcare/runbooks/slow-api"
      }
    },
    {
      "name": "PatientDataBreach",
      "expression": "increase(neonpro_security_incidents_total[1h]) > 0",
      "for": "1m",
      "labels": {
        "severity": "critical",
        "component": "security",
        "healthcare_impact": "critical",
        "compliance": "lgpd"
      },
      "annotations": {
        "summary": "Potential patient data breach detected",
        "description": "Security incidents detected in the last hour. Immediate investigation required for LGPD compliance.",
        "runbook_url": "https://docs.neonpro.healthcare/runbooks/data-breach"
      }
    },
    {
      "name": "AppointmentSystemFailure",
      "expression": "rate(neonpro_appointments_failed_total[5m]) > 1",
      "for": "2m",
      "labels": {
        "severity": "high",
        "component": "appointments",
        "healthcare_impact": "high"
      },
      "annotations": {
        "summary": "Appointment system failures",
        "description": "High rate of appointment failures. This affects patient scheduling and clinic operations.",
        "runbook_url": "https://docs.neonpro.healthcare/runbooks/appointment-failure"
      }
    },
    {
      "name": "BackupFailure",
      "expression": "neonpro_backup_success == 0",
      "for": "1h",
      "labels": {
        "severity": "critical",
        "component": "backup",
        "healthcare_impact": "high",
        "compliance": "anvisa"
      },
      "annotations": {
        "summary": "Backup system failure",
        "description": "Automated backups have failed. This impacts ANVISA compliance for medical record retention.",
        "runbook_url": "https://docs.neonpro.healthcare/runbooks/backup-failure"
      }
    },
    {
      "name": "AuditLogFailure",
      "expression": "rate(neonpro_audit_events_total[5m]) == 0",
      "for": "10m",
      "labels": {
        "severity": "warning",
        "component": "audit",
        "healthcare_impact": "medium",
        "compliance": ["lgpd", "anvisa", "cfm"]
      },
      "annotations": {
        "summary": "Audit logging system failure",
        "description": "No audit events detected in the last 10 minutes. This affects compliance monitoring.",
        "runbook_url": "https://docs.neonpro.healthcare/runbooks/audit-failure"
      }
    },
    {
      "name": "ComplianceViolation",
      "expression": "neonpro_compliance_violations_total > 0",
      "for": "1m",
      "labels": {
        "severity": "critical",
        "component": "compliance",
        "healthcare_impact": "critical"
      },
      "annotations": {
        "summary": "Healthcare compliance violation detected",
        "description": "Compliance violations detected. Immediate action required for regulatory compliance.",
        "runbook_url": "https://docs.neonpro.healthcare/runbooks/compliance-violation"
      }
    },
    {
      "name": "LowDiskSpace",
      "expression": "neonpro_disk_usage_percent > 85",
      "for": "5m",
      "labels": {
        "severity": "warning",
        "component": "infrastructure",
        "healthcare_impact": "medium"
      },
      "annotations": {
        "summary": "Low disk space",
        "description": "Disk usage is at {{ $value }}%. This may affect medical record storage and system performance.",
        "runbook_url": "https://docs.neonpro.healthcare/runbooks/disk-space"
      }
    },
    {
      "name": "AuthenticationFailure",
      "expression": "rate(neonpro_auth_failures_total[5m]) > 5",
      "for": "2m",
      "labels": {
        "severity": "warning",
        "component": "security",
        "healthcare_impact": "medium"
      },
      "annotations": {
        "summary": "High authentication failure rate",
        "description": "Authentication failures detected. This may indicate brute force attempts.",
        "runbook_url": "https://docs.neonpro.healthcare/runbooks/auth-failure"
      }
    }
  ]
}
