# Story 2.4: Hooks Distribution Migration - Brownfield Addition

## Status

Completed

## Story

**As a** Frontend Developer,
**I want** all React hooks migrated from root-level locations to appropriate package structures,
**So that** React hooks are properly organized and reusable following Turborepo best practices.

## Story Context

**Existing System Integration:**

- Integrates with: Current root-level React hooks scattered across directories
- Technology: React 18, TypeScript, custom hooks, state management
- Follows pattern: Existing package structure with proper hook organization
- Touch points: Components importing hooks, shared state management, hook composition

**Current State:**
- Root-level hooks in various locations (hooks/, components/, lib/)
- Mixed hook patterns and import structures
- Some hooks may be duplicated or fragmented

## Acceptance Criteria

**Functional Requirements:**

1. Identify and catalog all React hooks in root-level directories
2. Migrate hooks to `packages/ui/src/hooks/` for UI-specific hooks
3. Migrate business logic hooks to `packages/domain/src/hooks/`

**Integration Requirements:**

4. Existing hook imports continue to work via workspace references
5. Hook categorization follows clear domain boundaries
6. Integration maintains current hook functionality and state management

**Quality Requirements:**

7. All hooks preserve their original functionality
8. Hook dependencies are properly managed
9. TypeScript types for hooks are maintained and accurate

## Technical Notes

- **Integration Approach**: Categorize hooks by domain (UI vs business logic)
- **Existing Pattern Reference**: Follow established package hook organization
- **Key Constraints**: Maintain hook functionality and existing component integrations

## Tasks / Subtasks

### Phase 1: Hook Discovery and Analysis

- [ ] **Task 1.1: Scan for React Hooks**
  - [ ] Search for files with `use*` patterns in root directories
  - [ ] Identify hooks in `hooks/` directory (if exists)
  - [ ] Find hooks embedded in component files
  - [ ] Check `lib/` for business logic hooks
  - [ ] Catalog custom hooks vs third-party hooks

- [ ] **Task 1.2: Categorize Hooks by Domain**
  - [ ] UI Hooks: Form handling, component state, animations
  - [ ] Business Logic Hooks: Data fetching, API calls, domain logic
  - [ ] Utility Hooks: Common utilities, helpers, shared logic
  - [ ] Healthcare Hooks: Patient data, clinic operations, compliance

### Phase 2: UI Hooks Migration

- [ ] **Task 2.1: Migrate UI-Specific Hooks**
  - [ ] Move form handling hooks to `packages/ui/src/hooks/`
  - [ ] Move component state hooks to UI package
  - [ ] Move animation and interaction hooks to UI package
  - [ ] Update UI hook exports in package index

- [ ] **Task 2.2: Update UI Hook Imports**
  - [ ] Update component imports to use workspace references
  - [ ] Verify UI hooks work with shadcn/ui components
  - [ ] Test hook integration with Tailwind CSS
  - [ ] Validate TypeScript types for UI hooks

### Phase 3: Domain Hooks Migration

- [ ] **Task 3.1: Migrate Business Logic Hooks**
  - [ ] Move data fetching hooks to `packages/domain/src/hooks/`
  - [ ] Move API integration hooks to domain package
  - [ ] Move healthcare business logic hooks to domain
  - [ ] Move authentication/authorization hooks to domain

- [ ] **Task 3.2: Update Domain Hook Exports**
  - [ ] Create barrel exports for domain hooks
  - [ ] Organize hooks by business capability
  - [ ] Add proper TypeScript declarations
  - [ ] Document hook purposes and usage

### Phase 4: Hook Integration Testing

- [ ] **Task 4.1: Test Hook Functionality**
  - [ ] Verify all hooks maintain original behavior
  - [ ] Test hook composition and interaction
  - [ ] Validate hook performance characteristics
  - [ ] Check for any hook dependency issues

- [ ] **Task 4.2: Component Integration Validation**
  - [ ] Test hooks with existing components
  - [ ] Verify state management still works
  - [ ] Check hook re-rendering behavior
  - [ ] Validate TypeScript inference for hooks

## Definition of Done

- [ ] All React hooks cataloged and categorized
- [ ] UI hooks moved to `packages/ui/src/hooks/`
- [ ] Business logic hooks moved to `packages/domain/src/hooks/`
- [ ] Hook exports properly configured in packages
- [ ] All existing hook functionality preserved
- [ ] Component imports updated to use workspace references
- [ ] TypeScript types accurate and complete
- [ ] Hook integration tested and validated

## Risk and Compatibility Check

**Primary Risk:** Breaking hook dependencies and component integrations
**Mitigation:** Gradual migration with workspace references, thorough testing
**Rollback:** Restore hooks to original locations using git

**Compatibility Verification:**

- [ ] No breaking changes to hook APIs
- [ ] All hook dependencies resolved correctly
- [ ] Component state management preserved
- [ ] Hook performance characteristics maintained
- [ ] TypeScript compilation successful

## Hook Categories

**UI Hooks (packages/ui/src/hooks/):**
- Form handling hooks (useForm, useValidation)
- Component state hooks (useToggle, useDisclosure)
- Animation hooks (useTransition, useAnimation)
- UI interaction hooks (useHover, useClick)

**Domain Hooks (packages/domain/src/hooks/):**
- Data fetching hooks (usePatients, useAppointments)
- API integration hooks (useSupabase, useAPI)
- Authentication hooks (useAuth, usePermissions)
- Healthcare business logic hooks (useCompliance, useTreatments)

**Utility Hooks (packages/utils/src/hooks/):**
- Common utility hooks (useDebounce, useLocalStorage)
- Helper hooks (useAsync, useCounter)
- Shared logic hooks (useMediaQuery, useEventListener)

## Dependencies

- **Prerequisite**: Package structure establishment from previous stories
- **Blocks**: Required before component import updates in Story 2.6
- **Technology**: React 18, TypeScript, custom hooks, state management

## File Structure Result

```
packages/ui/src/hooks/
├── index.ts              # UI hook exports
├── useForm.ts           # Form handling
├── useToggle.ts         # UI state management
└── useAnimation.ts      # UI animations

packages/domain/src/hooks/
├── index.ts              # Domain hook exports
├── usePatients.ts       # Patient data management
├── useAuth.ts           # Authentication
└── useCompliance.ts     # Healthcare compliance

packages/utils/src/hooks/
├── index.ts              # Utility hook exports
├── useDebounce.ts       # Common utilities
└── useAsync.ts          # Async operations
```

---

## Change Log

| Date       | Version | Description                       | Author      |
| ---------- | ------- | --------------------------------- | ----------- |
| 2025-08-16 | 1.0     | Hooks distribution migration      | BMad Master |

## Dev Agent Record

_[To be populated by development agent during implementation]_

## QA Results

_[To be populated by QA agent during review]_