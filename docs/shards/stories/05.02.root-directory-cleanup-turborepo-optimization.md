# Story 05.02: Root Directory Cleanup and Turborepo Optimization

## Status
Draft

## Story
**As a** development team,
**I want** the root directory cleaned of legacy files and optimized for Turborepo best practices,
**so that** the monorepo structure is clean, maintainable, and follows enterprise-level standards.

## Acceptance Criteria
1. All legacy configuration files are consolidated or removed
2. All temporary analysis files are removed from root
3. Test configuration files are moved to appropriate workspace locations
4. Documentation files are organized into proper structure
5. Root package.json dependencies are cleaned (app-specific moved to workspaces)
6. Scripts and utility files are organized into appropriate locations
7. Legacy report files are archived or removed
8. Root directory contains only essential monorepo management files

## Tasks / Subtasks

- [ ] **Task 1: Audit Root Directory Files** (AC: 1,2,3,7)
  - [ ] Categorize all files in root directory by purpose
  - [ ] Identify legacy, temporary, and redundant files
  - [ ] Document dependencies and references to each file
  - [ ] Create cleanup plan with safety considerations

- [ ] **Task 2: Clean Legacy Configuration Files** (AC: 1)
  - [ ] Review and remove `jest.healthcare.config.js` (move to appropriate workspace)
  - [ ] Consolidate or remove duplicate configuration files
  - [ ] Archive `components.json` if not actively used
  - [ ] Clean up `.env` template files (keep only necessary ones)

- [ ] **Task 3: Remove Temporary Analysis Files** (AC: 2)
  - [ ] Remove `temp-examine-packages.js`
  - [ ] Remove `temp-examine-tsconfig.js`
  - [ ] Remove `temp-read-configs.js`
  - [ ] Remove `temp-view-nextconfig.js`
  - [ ] Remove `temp_analysis.txt`
  - [ ] Remove `test-file.js`

- [ ] **Task 4: Reorganize Test-Related Files** (AC: 3)
  - [ ] Move `playwright.config.ts` to `apps/web/` or `tools/testing/configs/`
  - [ ] Move `cypress.config.ts` to `apps/web/` if still used, or remove
  - [ ] Move `lighthouserc.js` to `tools/testing/configs/` or remove
  - [ ] Update any references to moved configurations

- [ ] **Task 5: Clean Root Package.json Dependencies** (AC: 5)
  - [ ] Move Supabase dependencies to `apps/web/package.json`
  - [ ] Move `dotenv` to `apps/web/package.json`
  - [ ] Keep only monorepo management tools in root
  - [ ] Update any references to moved dependencies

- [ ] **Task 6: Organize Scripts and Utilities** (AC: 6)
  - [ ] Move `supabase-connection-test.js` to `tools/testing/` or `scripts/`
  - [ ] Move `sync-prisma-supabase.js` to `scripts/database/`
  - [ ] Move `run-reconciliation-tests.js` to `tools/testing/`
  - [ ] Create proper script organization in `scripts/` directory
  - [ ] Update script execution paths in package.json

- [ ] **Task 7: Handle Legacy Reports and Documentation** (AC: 7,4)
  - [ ] Archive completion reports (EPIC-*, FINAL-*, etc.) to `docs/archive/`
  - [ ] Move implementation summaries to `docs/implementation/`
  - [ ] Remove outdated validation files
  - [ ] Consolidate related documentation
  - [ ] Update README.md to reflect new structure

- [ ] **Task 8: Clean Infrastructure and Build Files** (AC: 1,8)
  - [ ] Review `infrastructure/` directory relevance
  - [ ] Clean up build-related files in root
  - [ ] Ensure `instrumentation.ts` is in correct location
  - [ ] Review and organize Sentry configuration files

- [ ] **Task 9: Update Import Paths and References** (AC: 3,4,6)
  - [ ] Update all import statements referencing moved files
  - [ ] Update package.json scripts for new file locations
  - [ ] Update CI/CD configurations for new paths
  - [ ] Update documentation references

- [ ] **Task 10: Validate Clean Structure** (AC: 8)
  - [ ] Verify all essential monorepo files remain
  - [ ] Test that all moved configurations work correctly
  - [ ] Ensure all Turborepo tasks continue to function
  - [ ] Document final root directory structure

## Dev Notes

### Previous Story Insights
This story follows the testing infrastructure consolidation and addresses root directory chaos identified in the Turborepo audit.

### Root Directory Issues Identified
- **Legacy Files**: Multiple completion reports and analysis files
- **Configuration Sprawl**: Test configs scattered in root instead of workspaces
- **Dependency Pollution**: App-specific dependencies in root package.json
- **Temporary Files**: Multiple temp analysis files left behind
- **Documentation Chaos**: Implementation docs mixed with active files

### Files to Archive/Remove
```
# Completion Reports (move to docs/archive/)
- EPIC-01-IMPLEMENTATION-COMPLETE.md
- EPIC-04-HEALTHCARE-TESTING-COMPLETE.md
- FINAL-IMPLEMENTATION-VALIDATION-REPORT.md
- FINAL-SUPABASE-CONFIGURATION-COMPLETE.md
- MONOREPO-MIGRATION-COMPLETE.md
- PROJECT-COMPLETION-SUMMARY.md

# Temporary Analysis Files (remove)
- temp-examine-*.js
- temp_analysis.txt
- test-file.js

# Test Configuration (move to workspaces)
- jest.healthcare.config.js → tools/testing/configs/
- playwright.config.ts → apps/web/ or tools/testing/configs/
- cypress.config.ts → review usage first
```

### Target Root Directory Structure
```
neonpro/
├── .github/                 # GitHub workflows and configs
├── .bmad-core/             # BMad methodology files
├── .turbo/                 # Turborepo cache
├── apps/                   # Applications
├── packages/               # Shared packages
├── tools/                  # Development tools
├── docs/                   # Documentation
├── scripts/                # Utility scripts
├── package.json            # Root package management
├── turbo.json              # Turborepo configuration
├── pnpm-workspace.yaml     # Workspace definition
├── biome.jsonc            # Code formatting
├── tsconfig.json          # TypeScript config
├── README.md              # Project documentation
└── .gitignore             # Git ignore rules
```

### Dependencies to Move
From root `package.json` to `apps/web/package.json`:
- `@supabase/auth-helpers-nextjs`
- `@supabase/ssr`
- `@supabase/supabase-js`
- `dotenv`

### File Locations
- Archive directory: `docs/archive/`
- Scripts directory: `scripts/{category}/`
- Test configs: `tools/testing/configs/`
- Implementation docs: `docs/implementation/`

### Technical Constraints
- Must maintain all working functionality
- Must preserve important documentation
- Must not break existing CI/CD pipelines
- Must maintain Turborepo task compatibility

## Testing
### Testing Standards
- Verify all moved configurations work correctly
- Test all package.json scripts after dependency moves
- Validate Turborepo tasks function with new structure
- Ensure CI/CD pipelines work with new file locations

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-15 | 1.0 | Initial story creation | BMad Master |